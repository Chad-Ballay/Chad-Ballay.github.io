<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>Disclose The Agent - Write up - Chad&#x27;s Sandbox</title><meta name="description" content="Decided to start back up with some basic training after someone mentioned LetsDefend.io. The site impressed me. Here is a writeup on one of their public facing challenges that kind of shows what to expect. Disclose the Agent Premise is that you've got a PCAP file and you need to&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://chadballay.com/disclose-the-agent-writeup/"><link rel="alternate" type="application/atom+xml" href="https://chadballay.com/feed.xml" title="Chad&#x27;s Sandbox - RSS"><link rel="alternate" type="application/json" href="https://chadballay.com/feed.json" title="Chad&#x27;s Sandbox - JSON"><meta property="og:title" content="Disclose The Agent - Write up"><meta property="og:site_name" content="Chad's Sandbox"><meta property="og:description" content="Decided to start back up with some basic training after someone mentioned LetsDefend.io. The site impressed me. Here is a writeup on one of their public facing challenges that kind of shows what to expect. Disclose the Agent Premise is that you've got a PCAP file and you need to&hellip;"><meta property="og:url" content="https://chadballay.com/disclose-the-agent-writeup/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://chadballay.com/assets/css/fontawesome-all.min.css?v=bbcde81f26378440dac4c3d195714389"><link rel="stylesheet" href="https://chadballay.com/assets/css/style.css?v=d9c2229ab80241a1220556e7981365b6"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://chadballay.com/disclose-the-agent-writeup/"},"headline":"Disclose The Agent - Write up","datePublished":"2023-02-05T16:36-05:00","dateModified":"2023-02-06T04:28-05:00","description":"Decided to start back up with some basic training after someone mentioned LetsDefend.io. The site impressed me. Here is a writeup on one of their public facing challenges that kind of shows what to expect. Disclose the Agent Premise is that you've got a PCAP file and you need to&hellip;","author":{"@type":"Person","name":"Chad Ballay","url":"https://chadballay.com/authors/chad-ballay/"},"publisher":{"@type":"Organization","name":"Chad Ballay"}}</script></head><body class="is-preload"><div id="wrapper"><div id="main"><div class="inner"><header id="header"><a class="logo" href="https://chadballay.com/"><strong>Chad&#x27;s Sandbox</strong></a><ul class="icons"><li><a href="https://www.instagram.com/chadballay/" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li><li><a href="https://www.linkedin.com/in/chad-ballay" class="icon brands fa-linkedin"><span class="label">LinkedIn</span></a></li></ul></header><article class="post"><header class="main post__header"><time datetime="2023-02-05T16:36" class="post__date">February 5, 2023</time><h1>Disclose The Agent - Write up</h1></header><div class="post__inner post__entry"><p>Decided to start back up with some basic training after someone mentioned <a href="https://letsdefend.io/" target="_blank" rel="noopener noreferrer">LetsDefend.io</a>. The site impressed me. Here is a writeup on one of their public facing challenges that kind of shows what to expect. <a href="https://app.letsdefend.io/challenge/disclose-the-agent" target="_blank" rel="noopener noreferrer">Disclose the Agent</a> Premise is that you've got a PCAP file and you need to identify who the secret agent is, what they are doing, and who they are communicating with.</p><ol><li>Grab the PCAP file.<br><a href="https://api.letsdefend.io/download/downloadfile/smtpchallenge.zip" target="_blank" rel="noopener noreferrer">https://api.letsdefend.io/download/downloadfile/smtpchallenge.zip</a><br>Pass: 321 <br><br></li><li>Load it into WireShark.<br><figure class="post__image"><img loading="lazy" src="https://chadballay.com/media/posts/14/screenshot-from-2023-01-27-05-57-30.png" alt="" width="1406" height="677" sizes="(max-width: 48em) 100vw, 768px" srcset="https://chadballay.com/media/posts/14/responsive/screenshot-from-2023-01-27-05-57-30-xs.png 300w, https://chadballay.com/media/posts/14/responsive/screenshot-from-2023-01-27-05-57-30-sm.png 480w, https://chadballay.com/media/posts/14/responsive/screenshot-from-2023-01-27-05-57-30-md.png 768w"></figure><br><br></li><li>What is the email address of Ann's secret boyfriend?<br>Looked through the pcap file for all the From: and To: SMTP packets. From there I was able to see this. <a href="mailto:mistersecretx@aol.com">mistersecretx@aol.com<br><figure class="post__image"><img loading="lazy" src="https://chadballay.com/media/posts/14/screenshot-from-2023-01-31-22-41-35.png" alt="" width="1126" height="408" sizes="(max-width: 48em) 100vw, 768px" srcset="https://chadballay.com/media/posts/14/responsive/screenshot-from-2023-01-31-22-41-35-xs.png 300w, https://chadballay.com/media/posts/14/responsive/screenshot-from-2023-01-31-22-41-35-sm.png 480w, https://chadballay.com/media/posts/14/responsive/screenshot-from-2023-01-31-22-41-35-md.png 768w"></figure></a><br><br></li><li>What is Ann's email password?<br>This one took a bit more.  First thing was to look for some sort of PASS/AUTHENTICATE type interaction...  Oh wait, it literally says that.  The next step is decoding the string.  Used python but it isn't the only way.<br><figure class="post__image"><img src="https://chadballay.com/media/posts/14/Screenshot-from-2023-02-05-17-52-30.png" alt="" width="923" height="76" sizes="(max-width: 48em) 100vw, 768px" srcset="https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-05-17-52-30-xs.png 300w, https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-05-17-52-30-sm.png 480w, https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-05-17-52-30-md.png 768w"></figure><br><figure class="post__image"><img loading="lazy" src="https://chadballay.com/media/posts/14/Screenshot-from-2023-02-05-18-00-24.png" alt="" width="492" height="50" sizes="(max-width: 48em) 100vw, 768px" srcset="https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-05-18-00-24-xs.png 300w, https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-05-18-00-24-sm.png 480w, https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-05-18-00-24-md.png 768w"></figure><br><br></li><li>What is the name of the file that Ann sent to his secret lover?<br>For this one I used Wireshark's Follow function to see all the packets for this one SMTP message.  Then when it presented the total message I found the section for the attached document.<br><figure class="post__image"><img src="https://chadballay.com/media/posts/14/Screenshot-from-2023-02-05-18-34-13.png" alt="" width="1398" height="377" sizes="(max-width: 48em) 100vw, 768px" srcset="https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-05-18-34-13-xs.png 300w, https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-05-18-34-13-sm.png 480w, https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-05-18-34-13-md.png 768w"></figure><br><figure class="post__image"><img loading="lazy" src="https://chadballay.com/media/posts/14/Screenshot-from-2023-02-05-18-35-16.png" alt="" width="736" height="270" sizes="(max-width: 48em) 100vw, 768px" srcset="https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-05-18-35-16-xs.png 300w, https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-05-18-35-16-sm.png 480w, https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-05-18-35-16-md.png 768w"></figure><br><br></li><li>In what country will Ann meet with her secret lover?<br>This one was a bit harder. There was a reference about bringing a swimsuit in the body of the message but nothing more. To get it you had to grab the contents of the attachment and then build/view the file in an word doc application.  <br><figure class="post__image"><img loading="lazy" src="https://chadballay.com/media/posts/14/Screenshot-from-2023-02-06-02-34-19.png" alt="" width="951" height="753" sizes="(max-width: 48em) 100vw, 768px" srcset="https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-06-02-34-19-xs.png 300w, https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-06-02-34-19-sm.png 480w, https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-06-02-34-19-md.png 768w"></figure><br><br></li><li>What is the MD5 value of the attachment Ann sent?<br>This one ended up being as simple as running a command.<figure class="post__image"><img loading="lazy" src="https://chadballay.com/media/posts/14/Screenshot-from-2023-02-06-02-36-09.png" alt="" width="689" height="62" sizes="(max-width: 48em) 100vw, 768px" srcset="https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-06-02-36-09-xs.png 300w, https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-06-02-36-09-sm.png 480w, https://chadballay.com/media/posts/14/responsive/Screenshot-from-2023-02-06-02-36-09-md.png 768w"></figure><br><br></li></ol></div><footer class="post__inner post__footer"><p class="post__last-updated">This article was updated on February 6, 2023</p><div class="post__share"><h3>Share post:</h3><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fchadballay.com%2Fdisclose-the-agent-writeup%2F" class="js-share icon brands fa-linkedin" rel="nofollow noopener noreferrer"><span class="label">LinkedIn</span></a></div><div class="post__tag"><ul><li><strong>Tagged in:</strong></li><li><a href="https://chadballay.com/tags/cybersecurity/">Cybersecurity</a></li></ul></div><div class="post__bio"><img src="https://chadballay.com/media/website/profile_pic.PNG" loading="lazy" height="1024" width="1024" alt="Chad Ballay"><div><h3><a href="https://chadballay.com/authors/chad-ballay/" class="invert" rel="author">Chad Ballay</a></h3></div></div></footer></article></div></div><div id="sidebar"><div class="inner"><nav id="menu"><header class="major"><h2>Menu</h2></header><ul><li><a href="https://chadballay.com/impossible-list/" target="_self">Impossible List</a></li></ul></nav><section><header class="major"><h2>Get in touch</h2></header><ul class="contact"><li class="icon solid fa-envelope"><a href="mailto:chad.ballay@gmail.com">chad.ballay@gmail.com</a> </li><li class="icon solid fa-phone">(479) 381-8702</li><li class="icon solid fa-home">1905 SE Clark Street<br>Bentonville, AR 72712</li></ul></section><footer id="footer"><p class="copyright"></p></footer></div></div></div><script src="https://chadballay.com/assets/js/jquery.min.js?v=7c14a783dfeb3d238ccd3edd840d82ee"></script><script src="https://chadballay.com/assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="https://chadballay.com/assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="https://chadballay.com/assets/js/util.min.js?v=cbdaf7c20ac2883c77ae23acfbabd47e"></script><script src="https://chadballay.com/assets/js/main.min.js?v=08add7f6d435054ad38ec38d7cf8be40"></script><script>var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};</script></body></html>